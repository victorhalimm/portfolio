---
import Layout from "../layouts/Layout.astro";
import { MdOutlineEmail } from "react-icons/md";
import { FiGithub } from "react-icons/fi";
import { CiLinkedin } from "react-icons/ci";
import { FaInstagram } from "react-icons/fa";
import NavButton from "../components/Button/NavButton";
import { getCollection } from "astro:content";
import TypewriterBuilder from "../components/Typewriter/TypewriterBuilder";
import { portfolioCollectionsSchema } from "../content/config";
import {Image} from "astro:assets"

const projectCollection = await getCollection("projects");

const parseCollections = (collections: any) => {
  try {
      return portfolioCollectionsSchema.parse(collections);
  } catch (err: any) {
    console.log(err.message)
    return null
  }
};

const parsedProjectCollections = parseCollections(projectCollection)

const im = import.meta.glob<{ default: ImageMetadata }>('/src/assets/**/*.{jpeg,jpg,png,gif,webp}')
const roles = ["full-stack developer", "app developer", "full-time laboratory assistant"]
---

<Layout title="Victor Halim">
  <main
    class="relative w-full min-h-screen flex flex-col items-center justify-center"
  >
    <div class="text-3xl text-purple-600 font-semibold">victor halim</div>
    <div class="text-xl flex items-center pt-4 pb-8">
      <span class="text-gray-700">&#10100;</span>
      <span class="text-gray-500 w-full px-4">
        <TypewriterBuilder client:load texts={roles} />
      </span>
      <span class="text-gray-700">&#10101;</span>
    </div>

    <div
      class="flex items-center text-gray-500 flex-wrap font-thin text-3xl justify-between w-1/3"
    >
      <NavButton href="mailto:victorhalim18@gmail.com" icon={MdOutlineEmail} text="Email" />
      <NavButton href="https://github.com/victorhalimm" icon={FiGithub} text="GitHub" />
      <NavButton href="https://www.linkedin.com/in/victorhalimm/" icon={CiLinkedin} text="LinkedIn" />
      <NavButton href="https://www.instagram.com/victorhalim_/" icon={FaInstagram} text="Instagram" />
    </div>

    <p class="absolute bottom-8 text-base text-gray-500">
      Open for inquiries.
      <span class="text-purple-600"> Message me here! </span>
    </p>
  </main>

  <main class="min-h-screen">
    <div class="grid md:grid-cols-2 grid-cols-1 gap-4">
      {
        parsedProjectCollections?.map(({data}) => (
          <a
            class="group h-[50vh] hover:border-2 border-purple-600 duration-100"
            href=`/projects/${data.route}`
          >
            <Image
               src={im[data.mockup]()} 
               transition:name={data.name}
              alt={`${data.title} mockup`}
              class="h-full object-cover"
            />
            <div class="group-hover:text-purple-600 text-gray-500 mt-4 text-base">
              {data.title}
            </div>
          </a>
        ))
      }
    </div>
  </main>
</Layout>
